"use strict";exports.id=213,exports.ids=[213],exports.modules={5798:(e,t,l)=>{l.d(t,{As:()=>s,Lh:()=>i,VG:()=>a});let i=e=>{if(!e)return"";e.startsWith("http://")||e.startsWith("https://")||(e=`https://eennback-002-site1.atempurl.com${e.startsWith("/")?"":"/"}${e}`);try{let t=new URL(e);return t.pathname=t.pathname.replace(/ /g,"%20"),t.toString()}catch(t){return console.error("Failed to encode URL:",e,t),e.replace(/ /g,"%20")}},a=e=>e?/^https?:\/\//.test(e)?i(e):i(`https://eennback-002-site1.atempurl.com${e.startsWith("/")?"":"/"}${e}`):void 0,s=e=>{let t;if(console.log("=== NORMALIZING IMAGE PATH ==="),console.log("Input imagePath:",e),!e)return console.log("Empty imagePath, returning empty string"),"";if(e.startsWith("http://")||e.startsWith("https://")){console.log("Already full URL, encoding and returning:",e);let t=i(e);return console.log("Encoded URL:",t),t}let l="https://eennback-002-site1.atempurl.com";console.log("Backend URL from env:",l),e.startsWith("/uploads")||e.startsWith("/images")||e.startsWith("/static")?console.log("Backend path detected, constructed result:",t=`${l}${e}`):e.startsWith("/")?console.log("Absolute path detected, constructed result:",t=`${l}${e}`):console.log("Relative path detected, constructed result:",t=`${l}/${e}`);let a=i(t);return console.log("Final encoded result:",a),a}},1366:(e,t,l)=>{l.d(t,{A:()=>m});var i=l(5512),a=l(5103),s=l(8009),r=l(8531),o=l.n(r),c=l(5798);let n=({articles:e,categoryId:t,maxArticles:l=5})=>{let[i,a]=(0,s.useState)({isRotating:!1,previousArticleIds:[],newArticleId:null,rotationTimestamp:0}),r=e.filter(e=>e.isPublished&&e.categoryId===t).sort((e,t)=>new Date(t.createdDate).getTime()-new Date(e.createdDate).getTime()).slice(0,l);(0,s.useEffect)(()=>{if(0===r.length)return;let e=r.map(e=>e.id);a(l=>{let{previousArticleIds:i}=l;if(0===i.length)return{...l,previousArticleIds:e};let s=e[0]!==i[0],r=e.filter(e=>!i.includes(e)),o=r.length>0;return s||o?(console.log("\uD83D\uDD04 Article rotation detected:",{categoryId:t,hasNewTopArticle:s,newArticleIds:r,previousTop:i[0],newTop:e[0]}),setTimeout(()=>{a(e=>({...e,isRotating:!1,newArticleId:null}))},1200),{...l,isRotating:!0,newArticleId:r[0]||e[0],rotationTimestamp:Date.now(),previousArticleIds:e}):l})},[r,t]);let o=(0,s.useCallback)(()=>{a(e=>({...e,isRotating:!0,rotationTimestamp:Date.now()})),setTimeout(()=>{a(e=>({...e,isRotating:!1}))},1200)},[]),c=(0,s.useCallback)(e=>{if(!i.isRotating)return"";let t=`rotate-to-${e}`;return`article-rotation-animation ${t}`},[i.isRotating]),n=(0,s.useCallback)(e=>i.newArticleId===e,[i.newArticleId]);return{isRotating:i.isRotating,newArticleId:i.newArticleId,rotationTimestamp:i.rotationTimestamp,sortedArticles:r,triggerRotation:o,getRotationClass:c,isNewArticle:n,bigArticle:r[0]||null,smallArticles:r.slice(1,5),positions:{big:r[0]||null,topRight:r[1]||null,topLeft:r[2]||null,bottomLeft:r[3]||null,bottomRight:r[4]||null}}},d=({article:e,isAnimating:t=!1,isNew:l=!1})=>{let[r,n]=(0,s.useState)(null),[d,h]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let t=null;return(async()=>{if(!e.imagePath){console.log("BigArticle - No image path provided");return}console.log("BigArticle - Fetching image:",e.imagePath);let l="https://eennback-002-site1.atempurl.com";if(e.imagePath.includes(l.replace("https://","").replace("http://",""))||e.imagePath.includes("/uploads/"))try{let i=e.imagePath;i.startsWith("http://")||i.startsWith("https://")||(i=`${l}${i.startsWith("/")?"":"/"}${i}`);let a=(0,c.Lh)(i);console.log("BigArticle - Original path:",e.imagePath),console.log("BigArticle - Full URL:",i),console.log("BigArticle - Encoded URL for fetch:",a);let s=await fetch(a,{credentials:"include",mode:"cors",cache:"no-cache"});if(console.log("BigArticle - Fetch response status:",s.status,s.statusText),s.ok){let e=await s.blob();console.log("BigArticle - Blob created, size:",e.size,"type:",e.type),t=URL.createObjectURL(e),n(t),h(!0)}else{console.error("BigArticle - Fetch failed with status:",s.status);let i=e.imagePath.startsWith(l)?e.imagePath:`${l}${e.imagePath.startsWith("/")?"":"/"}${e.imagePath}`;if(i!==e.imagePath){console.log("BigArticle - Trying alternative URL:",i);let e=(0,c.Lh)(i);console.log("BigArticle - Encoded alternative URL:",e);let l=await fetch(e,{credentials:"include",mode:"cors",cache:"no-cache"});if(l.ok){let e=await l.blob();t=URL.createObjectURL(e),n(t),h(!0);return}}console.error("BigArticle - Failed to load image from API")}}catch(e){console.error("BigArticle - Fetch error:",e)}else/^https?:\/\//.test(e.imagePath)?(console.log("BigArticle - Using direct URL for external image"),n(e.imagePath),h(!1)):console.log("BigArticle - Unknown image path format")})(),()=>{t&&(URL.revokeObjectURL(t),console.log("BigArticle - Object URL revoked"))}},[e.imagePath]),r)?(0,i.jsx)(o(),{href:`/article/${e.id}`,className:"group h-full block",children:(0,i.jsxs)("div",{className:`relative h-full rounded-lg overflow-hidden ${t?"article-rotation-animation":""}`,children:[(0,i.jsx)(a.default,{src:r,alt:e.articleTitle,fill:!0,className:"object-cover w-full h-full absolute inset-0 scale-110 group-hover:scale-115 transition-transform duration-300",sizes:"(max-width: 768px) 100vw, 50vw",priority:!0,unoptimized:d}),(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent z-10"}),(0,i.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-6 z-20",children:[(0,i.jsx)("h3",{className:"dynamic-big-title line-clamp-2 leading-tight text-white font-bold article-title-shadow",children:e.articleTitle}),l&&(0,i.jsx)("div",{className:"absolute -top-2 -right-2",children:(0,i.jsx)("div",{className:"w-4 h-4 bg-primaryOther rounded-full animate-pulse flex items-center justify-center",children:(0,i.jsx)("span",{className:"text-white text-xs",children:"\uD83C\uDD95"})})})]})]})}):(0,i.jsx)("div",{className:"relative h-full rounded-lg overflow-hidden bg-gray-200 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primaryOther mb-2"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"جاري تحميل الصورة..."})]})})},h=({article:e,isAnimating:t=!1,position:l=""})=>{let[r,n]=(0,s.useState)(null),[d,h]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let t=null;return(async()=>{if(!e.imagePath){console.log("SmallArticle - No image path provided");return}console.log("SmallArticle - Fetching image:",e.imagePath);let l="https://eennback-002-site1.atempurl.com";if(e.imagePath.includes(l.replace("https://","").replace("http://",""))||e.imagePath.includes("/uploads/"))try{let i=e.imagePath;i.startsWith("http://")||i.startsWith("https://")||(i=`${l}${i.startsWith("/")?"":"/"}${i}`);let a=(0,c.Lh)(i);console.log("SmallArticle - Original path:",e.imagePath),console.log("SmallArticle - Full URL:",i),console.log("SmallArticle - Encoded URL for fetch:",a);let s=await fetch(a,{credentials:"include",mode:"cors",cache:"no-cache"});if(console.log("SmallArticle - Fetch response status:",s.status,s.statusText),s.ok){let e=await s.blob();console.log("SmallArticle - Blob created, size:",e.size,"type:",e.type),t=URL.createObjectURL(e),n(t),h(!0)}else{console.error("SmallArticle - Fetch failed with status:",s.status);let i=e.imagePath.startsWith(l)?e.imagePath:`${l}${e.imagePath.startsWith("/")?"":"/"}${e.imagePath}`;if(i!==e.imagePath){console.log("SmallArticle - Trying alternative URL:",i);let e=(0,c.Lh)(i);console.log("SmallArticle - Encoded alternative URL:",e);let l=await fetch(e,{credentials:"include",mode:"cors",cache:"no-cache"});if(l.ok){let e=await l.blob();t=URL.createObjectURL(e),n(t),h(!0);return}}console.error("SmallArticle - Failed to load image from API")}}catch(e){console.error("SmallArticle - Fetch error:",e)}else/^https?:\/\//.test(e.imagePath)?(console.log("SmallArticle - Using direct URL for external image"),n(e.imagePath),h(!1)):console.log("SmallArticle - Unknown image path format")})(),()=>{t&&(URL.revokeObjectURL(t),console.log("SmallArticle - Object URL revoked"))}},[e.imagePath]),r)?(0,i.jsx)(o(),{href:`/article/${e.id}`,className:"group h-full block",children:(0,i.jsxs)("div",{className:`relative h-full rounded-lg overflow-hidden ${t?`article-rotation-animation rotation-${l}`:""}`,children:[(0,i.jsx)(a.default,{src:r,alt:e.articleTitle,fill:!0,className:"object-cover w-full h-full absolute inset-0 scale-110 group-hover:scale-115 transition-transform duration-300",sizes:"(max-width: 768px) 100vw, 25vw",unoptimized:d}),(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/35 via-transparent to-transparent z-10"}),(0,i.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-3 z-20",children:[(0,i.jsx)("h4",{className:"dynamic-small-title line-clamp-2 leading-tight text-white font-bold article-title-shadow",children:e.articleTitle}),t&&(0,i.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,i.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse"})})]})]})}):(0,i.jsx)("div",{className:"relative h-full rounded-lg overflow-hidden bg-gray-200 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-primaryOther mb-1"}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"جاري التحميل..."})]})})},m=({category:e,showHeader:t=!0,showViewAll:l=!0,className:a=""})=>{let{isRotating:s,getRotationClass:r,isNewArticle:c,positions:m}=n({articles:e.articles,categoryId:e.id,maxArticles:5});return e.articles&&0!==e.articles.length?(0,i.jsxs)("div",{className:`bg-white rounded-lg category-card overflow-hidden mb-8 ${a}`,dir:"rtl",children:[t&&(0,i.jsx)("div",{className:"bg-primaryOther px-6 py-4",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("h2",{className:"text-white font-bold text-xl category-title",children:e.name}),l&&(0,i.jsxs)(o(),{href:`/category/${e.categorySlug}`,className:"text-white text-sm hover:underline flex items-center",children:["المزيد",(0,i.jsx)("span",{className:"mr-2 text-xs",children:"←"})]})]})}),(0,i.jsx)("div",{className:"p-6",children:(0,i.jsxs)("div",{className:"dynamic-grid",children:[(0,i.jsx)("div",{className:`big-article-container ${r("big")}`,children:m.big&&(0,i.jsx)(d,{article:m.big,isAnimating:s,isNew:c(m.big.id)})}),(0,i.jsxs)("div",{className:"small-articles-grid",children:[m.topRight&&(0,i.jsx)("div",{className:`small-article-container ${r("top-right")}`,children:(0,i.jsx)(h,{article:m.topRight,isAnimating:s,position:"top-right"})}),m.topLeft&&(0,i.jsx)("div",{className:`small-article-container ${r("top-left")}`,children:(0,i.jsx)(h,{article:m.topLeft,isAnimating:s,position:"top-left"})}),m.bottomLeft&&(0,i.jsx)("div",{className:`small-article-container ${r("bottom-left")}`,children:(0,i.jsx)(h,{article:m.bottomLeft,isAnimating:s,position:"bottom-left"})}),m.bottomRight&&(0,i.jsx)("div",{className:`small-article-container ${r("bottom-right")}`,children:(0,i.jsx)(h,{article:m.bottomRight,isAnimating:s,position:"bottom-right"})})]})]})})]}):null}},440:(e,t,l)=>{l.r(t),l.d(t,{default:()=>a});var i=l(8077);let a=async e=>[{type:"image/x-icon",sizes:"850x874",url:(0,i.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]}};